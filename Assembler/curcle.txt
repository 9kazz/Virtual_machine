PUSH 40
POPR RCX ; SIZE X

PUSH 40
POPR RDX ; SIZE Y

PUSH -1
POPR RAX ; Ð¥ COORD

PUSH 0
POPR RBX ; Y COORD

IN
POPR RFX ; RADIUS

IN
POPR RGX ; CENTER COORD X

IN
POPR RHX ; CENTER COORD Y

PUSH -1 ; supportive commands
PUSH -1 ; supportive commands

OneIter:
OUT
OUT
CALL :NextPixel
CALL :CalcPixelNum
CALL :DrawPixel
PUSHR REX
PUSHR RCX
PUSHR RDX
MUL
JB :OneIter
HLT

    CalcPixelNum:
        PUSHR RBX ; Y COORD
        PUSHR RCX ; SIZE X
        MUL
        PUSHR RAX ; X COORD
        ADD
        POPR REX ; Safe pixel number
        RET

    NextPixel:
        PUSHR RCX
        PUSHR RAX
        JBE :NewLine
        CALL :IncreaseX
        OUT
        OUT
        RET

        NewLine:
            CALL :IncreaseY
            OUT
            OUT
            RET

    IncreaseX:
        PUSH 1
        PUSHR RAX
        ADD
        POPR RAX ; X = X + 1
        RET

    IncreaseY:
        PUSH 0
        POPR RAX ; X = 0
        PUSH 1
        PUSHR RBX
        ADD
        POPR RBX ; Y = Y + 1
        RET

    DrawPixel:
        PUSHR RAX
        PUSHR RGX 
        SUB ; X - X(centre)
        PUSHR RAX
        PUSHR RGX 
        SUB
        MUL ; ( X - X(centre) ) ^ 2
        PUSH 2
        MUL

        PUSHR RBX
        PUSHR RHX
        SUB ; Y - Y(centre)
        PUSHR RBX
        PUSHR RHX
        SUB
        MUL ; ( Y - Y(centre) ) ^ 2

        ADD ; ( X - X(centre) ) ^ 2 + ( Y - Y(centre) ) ^ 2

        PUSHR RFX
        PUSHR RFX 
        MUL ; R ^ 2

        JBE :PrintHash
        OUT
        OUT
        PUSH 46
        POPM [REX] ; print "."
        RET

        PrintHash:
            OUT
            OUT
            PUSH 35
            POPM [REX] ; print "#"
            RET